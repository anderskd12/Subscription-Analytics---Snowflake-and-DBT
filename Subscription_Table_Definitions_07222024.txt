

create or replace TABLE SUBSCRIPTION_PROJECT.SOURCE.CUSTOMERS (
	CUSTOMER_ID VARCHAR(16777216),
	COMPANY_NAME VARCHAR(16777216),
	COMPANY_SIZE VARCHAR(16777216),
	COMPANY_TYPE VARCHAR(16777216),
	INDUSTRY VARCHAR(16777216),
	COUNTRY VARCHAR(16777216),
	CREATED_AT DATE,
	ACQUISITION_CHANNEL VARCHAR(16777216),
	IS_ACTIVE BOOLEAN
);


create or replace TABLE SUBSCRIPTION_PROJECT.SOURCE.INVOICES (
	INVOICE_ID VARCHAR(16777216),
	SUBSCRIPTION_ID VARCHAR(16777216),
	CUSTOMER_ID VARCHAR(16777216),
	INVOICE_DATE DATE,
	DUE_DATE DATE,
	PAID_DATE DATE,
	AMOUNT NUMBER(38,0),
	DISCOUNT_AMOUNT NUMBER(38,16),
	FINAL_AMOUNT NUMBER(38,1),
	STATUS VARCHAR(16777216),
	BILLING_PERIOD_START DATE,
	BILLING_PERIOD_END DATE,
	CREATED_AT DATE
);


create or replace TABLE SUBSCRIPTION_PROJECT.SOURCE.OPPORTUNITIES (
	OPPORTUNITY_ID VARCHAR(16777216),
	CUSTOMER_ID VARCHAR(16777216),
	OPPORTUNITY_NAME VARCHAR(16777216),
	STAGE VARCHAR(16777216),
	LEAD_SOURCE VARCHAR(16777216),
	DEAL_VALUE NUMBER(38,0),
	PROBABILITY NUMBER(38,0),
	CREATED_DATE DATE,
	CLOSE_DATE DATE,
	SALES_REP VARCHAR(16777216)
);


create or replace TABLE SUBSCRIPTION_PROJECT.SOURCE.PAYMENTS (
	PAYMENT_ID VARCHAR(16777216),
	INVOICE_ID VARCHAR(16777216),
	CUSTOMER_ID VARCHAR(16777216),
	AMOUNT NUMBER(38,1),
	CURRENCY VARCHAR(16777216),
	PAYMENT_METHOD VARCHAR(16777216),
	PAYMENT_DATE DATE,
	STRIPE_CHARGE_ID VARCHAR(16777216),
	STATUS VARCHAR(16777216),
	CREATED_AT DATE
);


create or replace TABLE SUBSCRIPTION_PROJECT.SOURCE.SUBSCRIPTIONS (
	SUBSCRIPTION_ID VARCHAR(16777216),
	CUSTOMER_ID VARCHAR(16777216),
	PLAN_ID VARCHAR(16777216),
	BILLING_CYCLE VARCHAR(16777216),
	USER_COUNT NUMBER(38,0),
	START_DATE DATE,
	END_DATE DATE,
	STATUS VARCHAR(16777216),
	CREATED_AT DATE,
	UPDATED_AT DATE
);


create or replace TABLE SUBSCRIPTION_PROJECT.SOURCE.SUBSCRIPTION_PLANS (
	PLAN_ID VARCHAR(16777216),
	PLAN_NAME VARCHAR(16777216),
	PRICE_MONTHLY NUMBER(38,0),
	PRICE_ANNUAL NUMBER(38,0),
	MAX_DEVICES NUMBER(38,0)
);


create or replace TABLE SUBSCRIPTION_PROJECT.SOURCE.USAGE_DATA (
	USAGE_ID VARCHAR(16777216),
	SUBSCRIPTION_ID VARCHAR(16777216),
	CUSTOMER_ID VARCHAR(16777216),
	MONTH DATE,
	DEVICES_CONNECTED NUMBER(38,0),
	DATA_TRANSFER_GB NUMBER(38,2),
	ACTIVE_USERS NUMBER(38,0),
	CONNECTION_HOURS NUMBER(38,2),
	CREATED_AT DATE
);

-- Don't forget this for masking the source data!
SELECT  replace(OPPORTUNITY_NAME, 'Tailscale', 'TS'), * FROM OPPORTUNITIES
UPDATE OPPORTUNITIES SET OPPORTUNITY_NAME = REPLACE(OPPORTUNITY_NAME, 'Tailscale', 'TS')


